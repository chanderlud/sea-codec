const e=(e,t=4294967295,U=79764919)=>{const s=new Int32Array(256);let n,r,o,a=t;for(n=0;n<256;n++){for(o=n<<24,r=8;r>0;--r)o=2147483648&o?o<<1^U:o<<1;s[n]=o}for(n=0;n<e.length;n++)a=a<<8^s[255&(a>>24^e[n])];return a},t=(t,U=e)=>{const s=e=>new Uint8Array(e.length/2).map((t,U)=>parseInt(e.substring(2*U,2*(U+1)),16)),n=e=>s(e)[0],r=new Map;[,8364,,8218,402,8222,8230,8224,8225,710,8240,352,8249,338,,381,,,8216,8217,8220,8221,8226,8211,8212,732,8482,353,8250,339,,382,376].forEach((e,t)=>r.set(e,t));const o=new Uint8Array(t.length);let a,i,l,d=!1,u=0,c=42,T=t.length>13&&"dynEncode"===t.substring(0,9),h=0;T&&(h=11,i=n(t.substring(9,h)),i<=1&&(h+=2,c=n(t.substring(11,h))),1===i&&(h+=8,l=(e=>new DataView(s(e).buffer).getInt32(0,!0))(t.substring(13,h))));const m=256-c;for(let e=h;e<t.length;e++)if(a=t.charCodeAt(e),61!==a||d){if(92===a&&e<t.length-5&&T){const U=t.charCodeAt(e+1);117!==U&&85!==U||(a=parseInt(t.substring(e+2,e+6),16),e+=5)}if(a>255){const e=r.get(a);e&&(a=e+127)}d&&(d=!1,a-=64),o[u++]=a<c&&a>0?a+m:a-c}else d=!0;const p=o.subarray(0,u);if(T&&1===i){const e=U(p);if(e!==l){const t="Decode failed crc32 validation";throw console.error("`simple-yenc`\n",t+"\n","Expected: "+l+"; Got: "+e+"\n","Visit https://github.com/eshaz/simple-yenc for more information"),Error(t)}}return p};function U(){const e=Uint8Array,s=Float32Array;U.modules||Object.defineProperties(U,{modules:{value:new WeakMap},setModule:{value(e,t){U.modules.set(e,Promise.resolve(t))}},getModule:{value(e,s){let n=U.modules.get(e);return n||(n=s?WebAssembly.compile(t(s)):U.inflateDynEncodeString(s=e.wasm).then(e=>WebAssembly.compile(e)),U.modules.set(e,n)),n}},concatFloat32:{value(e,t){let U=new s(t),n=0,r=0;for(;n<e.length;)U.set(e[n],r),r+=e[n++].length;return U}},getDecodedAudio:{value:(e,t,U,s,n)=>({errors:e,channelData:t,samplesDecoded:U,sampleRate:s,bitDepth:n})},getDecodedAudioMultiChannel:{value(e,t,s,n,r,o){let a,i,l=[];for(a=0;a<s;a++){const e=[];for(i=0;i<t.length;)e.push(t[i++][a]||[]);l.push(U.concatFloat32(e,n))}return U.getDecodedAudio(e,l,n,r,o)}},inflateDynEncodeString:{value:s=>(s=t(s),new Promise(t=>{const n=String.raw`dynEncode0114db91da9bu*ttt$#U¤¤U¤¤3yzzss|yusvuyÚ&4<054<,5T44^T44<(6U~J(44< ~A544U~6J0444545 444J0444J,4U4UÒ7U454U4Z4U4U^/6545T4T44BU~64CU~O4U54U~5 U5T4B4Z!4U~5U5U5T4U~6U4ZTU5U5T44~4O4U2ZTU5T44Z!4B6T44U~64B6U~O44U~4O4U~54U~5 44~C4~54U~5 44~5454U4B6Ub!444~UO4U~5 U54U4ZTU#44U$464<4~B6^4<444~U~B4U~54U544~544~U5 µUä#UJUè#5TT4U0ZTTUX5U5T4T4Uà#~4OU4U $~C4~54U~5 T44$6U\!TTT4UaT4<6T4<64<Z!44~4N4<U~5 4UZ!4U±_TU#44UU6UÔ~B$544$6U\!4U6U¤#~B44Uä#~B$~64<6_TU#444U~B~6~54<Y!44<_!T4Y!4<64~444~AN44<U~6J4U5 44J4U[!U#44UO4U~54U~5 U54 7U6844J44J 4UJ4UJ04VK(44<J44<J$4U´~54U~5 4U¤~5!TTT4U$5"U5TTTTTTT4U$"4VK,U54<(6U~64<$6_!4< 64~6A54A544U~6#J(U54A4U[!44J(44#~A4U6UUU[!4464~64_!4<64~54<6T4<4]TU5 T4Y!44~44~AN4U~54U~54U5 44J(44J UÄA!U5U#UôJU"UÔJU#UÔ"JU#U´"JT4U´ZTU5T4UôZTU5T4UDZTU5T4U$[T44~UO4U~5 UÔUô4U~U´$.U5T4UP[T4U~4~UO4U~5 U#<U#<4U~U2$.UÄUN 44 ~UO4U~5 44!~UO4U~5 4U~4~UO4U~5 44J44J(U5 44U¤~J@44Uä~J<44UD~J844U~J44U$54U$5U54U$54U1^4U1^!4U~54U~5U54U~6U4U^/65T4T4U$54U~4BU~4O4U54U~5 UU'464U'_/54UU~5T4T4U~4BU~UO4U54U~5 U54Uä~4U¤~4U~U'$!44~5U5T44\T44U<~$6U\!4U#aT4U~4U~4O4U~5 U5U5U5TTT4U$"4YTU5 4U4~C5U5 U5U5444$4~64~\TU5 4U~4U~5T4Y!44O4U~54U~54U5 4CYTU5 4Uä~4U¤~4U~4$6TU54U\!44Bæ4Bä~[!4U~4UD~4U~4U~4$6TU54U\!44B4B~[!44U<~4U4~$5 4U"U#$544"Y!454U^!44<J44<(J454U~84­UN!#%'+/37?GOWgw·×÷Uä;U9$%& !"#`;U.getModule(U,n).then(e=>WebAssembly.instantiate(e,{})).then(({exports:U})=>{const n=new Map(Object.entries(U)),r=n.get("puff"),o=n.get("memory").buffer,a=new e(o),i=new DataView(o);let l=n.get("__heap_base");const d=s.length,u=l;l+=4,i.setInt32(u,d,!0);const c=l;l+=d,a.set(s,c);const T=l;l+=4,i.setInt32(T,a.byteLength-l,!0),r(l,T,c,u),t(a.slice(l,l+i.getInt32(T,!0)))})}))}}),Object.defineProperty(this,"wasm",{enumerable:!0,get:()=>this._wasm}),this.getOutputChannels=(e,t,U)=>{let s=[],n=0;for(;n<t;)s.push(e.slice(n*U,n++*U+U));return s},this.allocateTypedArray=(e,t,U=!0)=>{const s=this._wasm.malloc(t.BYTES_PER_ELEMENT*e);return U&&this._pointers.add(s),{ptr:s,len:e,buf:new t(this._wasm.HEAP,s,e)}},this.free=()=>{this._pointers.forEach(e=>{this._wasm.free(e)}),this._pointers.clear()},this.codeToString=e=>{const t=[],U=new Uint8Array(this._wasm.HEAP);for(let s=U[e];0!==s;s=U[++e])t.push(s);return String.fromCharCode.apply(null,t)},this.addError=(e,t,U,s,n,r)=>{e.push({message:t,frameLength:U,frameNumber:s,inputBytes:n,outputSamples:r})},this.instantiate=(e,t)=>(t&&U.setModule(e,t),this._wasm=new e(U).instantiate(),this._pointers=new Set,this._wasm.ready.then(()=>this))}var s=Worker;class n extends((()=>globalThis.Worker||s)()){constructor(e,t,s,n){U.modules||new U;let r=U.modules.get(s);if(!r){let e,t="text/javascript",o=`'use strict';(${((e,t,U)=>{let s,n,r=new Promise(e=>{n=e});self.onmessage=({data:{id:o,command:a,data:i}})=>{let l,d=r,u={id:o};"init"===a?(Object.defineProperties(e,{WASMAudioDecoderCommon:{value:t},EmscriptenWASM:{value:U},module:{value:i.module},isWebWorker:{value:!0}}),s=new e(i.options),n()):"free"===a?s.free():"ready"===a?d=d.then(()=>s.ready):"reset"===a?d=d.then(()=>s.reset()):(Object.assign(u,s[a](Array.isArray(i)?i.map(e=>new Uint8Array(e)):new Uint8Array(i))),l=u.channelData?u.channelData.map(e=>e.buffer):[]),d.then(()=>self.postMessage(u,l))}}).toString()})(${s}, ${U}, ${n})`;try{e=void 0!==process.versions.node}catch{}r=e?`data:${t};base64,${Buffer.from(o).toString("base64")}`:URL.createObjectURL(new Blob([o],{type:t})),U.modules.set(s,r)}super(r,{name:t}),this._id=Number.MIN_SAFE_INTEGER,this._enqueuedOperations=new Map,this.onmessage=({data:e})=>{const{id:t,...U}=e;this._enqueuedOperations.get(t)(U),this._enqueuedOperations.delete(t)},new n(U).getModule().then(t=>{this.postToDecoder("init",{module:t,options:e})})}async postToDecoder(e,t){return new Promise(U=>{this.postMessage({command:e,id:this._id,data:t}),this._enqueuedOperations.set(this._id++,U)})}get ready(){return this.postToDecoder("ready")}async free(){await this.postToDecoder("free").finally(()=>{this.terminate()})}async reset(){await this.postToDecoder("reset")}}const r=(e,t)=>{Object.defineProperty(e,"name",{value:t})};export{U as W,n as a,r as b};
//# sourceMappingURL=utilities-0f571cba.js.map
